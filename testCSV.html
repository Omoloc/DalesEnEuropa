<!DOCTYPE html>
<html>
<head>
    <title>Generar CSV y Agregar Datos</title>
</head>
<body>
    <h1>Generar CSV y Agregar Datos</h1>

    <table id="dataTable" border="1">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Edad</th>
                <th>Ciudad</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Juan</td>
                <td>28</td>
                <td>Madrid</td>
            </tr>
            <tr>
                <td>Ana</td>
                <td>22</td>
                <td>Barcelona</td>
            </tr>
            <tr>
                <td>Luis</td>
                <td>35</td>
                <td>Valencia</td>
            </tr>
        </tbody>
    </table>

    <h2>Agregar Nueva Fila</h2>
    <form id="dataForm">
        <label for="name">Nombre:</label>
        <input type="text" id="name" required><br>
        <label for="age">Edad:</label>
        <input type="number" id="age" required><br>
        <label for="city">Ciudad:</label>
        <input type="text" id="city" required><br>
        <button type="submit">Agregar Fila</button>
    </form>

    <button id="downloadBtn">Descargar CSV</button>

    <script>
        document.getElementById('dataForm').addEventListener('submit', function (event) {
            event.preventDefault();

            const name = document.getElementById('name').value;
            const age = document.getElementById('age').value;
            const city = document.getElementById('city').value;

            const table = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();

            const nameCell = newRow.insertCell(0);
            const ageCell = newRow.insertCell(1);
            const cityCell = newRow.insertCell(2);

            nameCell.textContent = name;
            ageCell.textContent = age;
            cityCell.textContent = city;

            document.getElementById('dataForm').reset();
        });

        document.getElementById('downloadBtn').addEventListener('click', function () {
            const table = document.getElementById('dataTable');
            const rows = table.getElementsByTagName('tr');
            let csvContent = '';

            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('th').length > 0 ? rows[i].getElementsByTagName('th') : rows[i].getElementsByTagName('td');
                let rowContent = [];
                for (let j = 0; j < cells.length; j++) {
                    rowContent.push(cells[j].textContent);
                }
                csvContent += rowContent.join(',') + '\n';
            }

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'datos.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        });
    </script>
</body>
</html>
